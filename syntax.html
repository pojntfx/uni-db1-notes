<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Felicitas Pojtinger" />
  <meta name="dcterms.date" content="2022-02-01" />
  <meta name="keywords" content="databases, oracle, hdm-stuttgart" />
  <title>Uni DB1 Syntax Details</title>
  <style>
html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
background-color: #1a1a1a;
border: none;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Uni DB1 Syntax Details</h1>
<p class="subtitle">Syntax details for the DB1 (databases) course at HdM
Stuttgart</p>
<p class="author">Felicitas Pojtinger</p>
<p class="date">2022-02-01</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#acknowledgements" id="toc-acknowledgements"><span class="toc-section-number">1.1</span> Acknowledgements</a></li>
<li><a href="#reset-everything" id="toc-reset-everything"><span class="toc-section-number">1.2</span> Reset Everything</a></li>
<li><a href="#sql" id="toc-sql"><span class="toc-section-number">1.3</span> SQL</a>
<ul>
<li><a href="#operators" id="toc-operators"><span class="toc-section-number">1.3.1</span> Operators</a></li>
<li><a href="#joins" id="toc-joins"><span class="toc-section-number">1.3.2</span> Joins</a></li>
<li><a href="#aliases" id="toc-aliases"><span class="toc-section-number">1.3.3</span> Aliases</a></li>
<li><a href="#limits-and-pagination" id="toc-limits-and-pagination"><span class="toc-section-number">1.3.4</span> Limits and Pagination</a></li>
<li><a href="#dates-and-intervals" id="toc-dates-and-intervals"><span class="toc-section-number">1.3.5</span> Dates and Intervals</a></li>
<li><a href="#expressions" id="toc-expressions"><span class="toc-section-number">1.3.6</span> Expressions</a></li>
<li><a href="#grouping-and-ordering" id="toc-grouping-and-ordering"><span class="toc-section-number">1.3.7</span> Grouping and Ordering</a></li>
<li><a href="#counting-and-sums" id="toc-counting-and-sums"><span class="toc-section-number">1.3.8</span> Counting and Sums</a></li>
<li><a href="#inserting" id="toc-inserting"><span class="toc-section-number">1.3.9</span> Inserting</a></li>
<li><a href="#switches" id="toc-switches"><span class="toc-section-number">1.3.10</span> Switches</a></li>
<li><a href="#helper-functions" id="toc-helper-functions"><span class="toc-section-number">1.3.11</span> Helper Functions</a></li>
<li><a href="#auto-generated-primary-keys" id="toc-auto-generated-primary-keys"><span class="toc-section-number">1.3.12</span> Auto-Generated Primary
Keys</a></li>
<li><a href="#modifying-columns" id="toc-modifying-columns"><span class="toc-section-number">1.3.13</span> Modifying Columns</a></li>
<li><a href="#virtual-columns" id="toc-virtual-columns"><span class="toc-section-number">1.3.14</span> Virtual Columns</a></li>
<li><a href="#modifying-tables" id="toc-modifying-tables"><span class="toc-section-number">1.3.15</span> Modifying Tables</a></li>
<li><a href="#constraints" id="toc-constraints"><span class="toc-section-number">1.3.16</span> Constraints</a></li>
<li><a href="#types" id="toc-types"><span class="toc-section-number">1.3.17</span> Types</a></li>
<li><a href="#views" id="toc-views"><span class="toc-section-number">1.3.18</span> Views</a></li>
<li><a href="#indexes" id="toc-indexes"><span class="toc-section-number">1.3.19</span> Indexes</a></li>
</ul></li>
<li><a href="#plsql" id="toc-plsql"><span class="toc-section-number">1.4</span> PL/SQL</a>
<ul>
<li><a href="#block-structure" id="toc-block-structure"><span class="toc-section-number">1.4.1</span> Block Structure</a></li>
<li><a href="#variables" id="toc-variables"><span class="toc-section-number">1.4.2</span> Variables</a></li>
<li><a href="#fetching-data" id="toc-fetching-data"><span class="toc-section-number">1.4.3</span> Fetching Data</a></li>
<li><a href="#branches-and-expressions" id="toc-branches-and-expressions"><span class="toc-section-number">1.4.4</span> Branches and
Expressions</a></li>
<li><a href="#switches-1" id="toc-switches-1"><span class="toc-section-number">1.4.5</span> Switches</a></li>
<li><a href="#labels-and-goto" id="toc-labels-and-goto"><span class="toc-section-number">1.4.6</span> Labels and Goto</a></li>
<li><a href="#loops" id="toc-loops"><span class="toc-section-number">1.4.7</span> Loops</a></li>
<li><a href="#types-and-objects" id="toc-types-and-objects"><span class="toc-section-number">1.4.8</span> Types and Objects</a></li>
<li><a href="#exceptions" id="toc-exceptions"><span class="toc-section-number">1.4.9</span> Exceptions</a></li>
<li><a href="#cursors" id="toc-cursors"><span class="toc-section-number">1.4.10</span> Cursors</a></li>
<li><a href="#locks" id="toc-locks"><span class="toc-section-number">1.4.11</span> Locks</a></li>
<li><a href="#procedures" id="toc-procedures"><span class="toc-section-number">1.4.12</span> Procedures</a></li>
<li><a href="#functions" id="toc-functions"><span class="toc-section-number">1.4.13</span> Functions</a></li>
<li><a href="#packages" id="toc-packages"><span class="toc-section-number">1.4.14</span> Packages</a></li>
<li><a href="#triggers" id="toc-triggers"><span class="toc-section-number">1.4.15</span> Triggers</a></li>
<li><a href="#maps" id="toc-maps"><span class="toc-section-number">1.4.16</span> Maps</a></li>
<li><a href="#arrays" id="toc-arrays"><span class="toc-section-number">1.4.17</span> Arrays</a></li>
</ul></li>
</ul>
</nav>
<blockquote>
<p>“so basically i am monkey” - monke, <em>monkeeee</em></p>
</blockquote>
<h2 data-number="1.1" id="acknowledgements"><span class="header-section-number">1.1</span> Acknowledgements</h2>
<p>Most of the following is based on the <a href="https://www.oracletutorial.com/oracle-basics/">Oracle
Tutorial</a>.</p>
<h2 data-number="1.2" id="reset-everything"><span class="header-section-number">1.2</span> Reset Everything</h2>
<p>Run the following to get the commands to drop all tables and their
constraints:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> (<span class="kw">select</span> index_name <span class="kw">from</span> user_indexes <span class="kw">where</span> index_name <span class="kw">not</span> <span class="kw">like</span> <span class="st">&#39;%_PK&#39;</span>) <span class="cf">loop</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">execute</span> <span class="kw">immediate</span> <span class="st">&#39;drop index &#39;</span> <span class="op">||</span> i.index_name;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> (<span class="kw">select</span> trigger_name <span class="kw">from</span> user_triggers) <span class="cf">loop</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">execute</span> <span class="kw">immediate</span> <span class="st">&#39;drop trigger &#39;</span> <span class="op">||</span> i.trigger_name;</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> (<span class="kw">select</span> view_name <span class="kw">from</span> user_views) <span class="cf">loop</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">execute</span> <span class="kw">immediate</span> <span class="st">&#39;drop view &#39;</span> <span class="op">||</span> i.view_name;</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> (<span class="kw">select</span> table_name <span class="kw">from</span> user_tables) <span class="cf">loop</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">execute</span> <span class="kw">immediate</span> <span class="st">&#39;drop table &#39;</span> <span class="op">||</span> i.table_name <span class="op">||</span> <span class="st">&#39; cascade constraints&#39;</span>;</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">execute</span> <span class="kw">immediate</span> <span class="st">&#39;purge recyclebin&#39;</span>;</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div>
<p>Now copy &amp; paste the output into SQL Developer’s SQL worksheet
and hit <kbd>F5</kbd>.</p>
<h2 data-number="1.3" id="sql"><span class="header-section-number">1.3</span> SQL</h2>
<h3 data-number="1.3.1" id="operators"><span class="header-section-number">1.3.1</span> Operators</h3>
<table style="width:97%;">
<colgroup>
<col style="width: 17%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">=</td>
<td style="text-align: left;">Equality</td>
</tr>
<tr class="even">
<td style="text-align: left;">!=,&lt;&gt;</td>
<td style="text-align: left;">Inequality</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&gt;</td>
<td style="text-align: left;">Greater than</td>
</tr>
<tr class="even">
<td style="text-align: left;">&lt;</td>
<td style="text-align: left;">Less than</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&gt;=</td>
<td style="text-align: left;">Greater than or equal to</td>
</tr>
<tr class="even">
<td style="text-align: left;">&lt;=</td>
<td style="text-align: left;">Less than or equal to</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IN</td>
<td style="text-align: left;">Equal to any value in a list of
values</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANY/ SOME/ ALL</td>
<td style="text-align: left;">Compare a value to a list or subquery. It
must be preceded by another operator such as =, &gt;, &lt;.j</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NOT IN</td>
<td style="text-align: left;">Not equal to any value in a list of
values</td>
</tr>
<tr class="even">
<td style="text-align: left;">[NOT] BETWEEN n and m</td>
<td style="text-align: left;">Equivalent to [Not] &gt;= n and &lt;=
y.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[NOT] EXISTS</td>
<td style="text-align: left;">Return true if subquery returns at least
one row</td>
</tr>
<tr class="even">
<td style="text-align: left;">IS [NOT] NULL</td>
<td style="text-align: left;">NULL test</td>
</tr>
</tbody>
</table>
<h3 data-number="1.3.2" id="joins"><span class="header-section-number">1.3.2</span> Joins</h3>
<ul>
<li><p>An <strong>inner join</strong> matches stuff in both tables:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">inner</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color;</span></code></pre></div></li>
<li><p>A <strong>left (outer) join</strong> matches everything in the
left tables plus what matches in the right table:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">left</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color</span></code></pre></div></li>
<li><p>This <strong>left (outer)</strong> join matches everything that
is in the left table and not in the right table:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">left</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color <span class="kw">where</span> b.<span class="kw">id</span> <span class="kw">is</span> <span class="kw">null</span></span></code></pre></div></li>
<li><p>A <strong>right (outer) join</strong> matches everything in the
right join plus what matches in the left table:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">right</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color;</span></code></pre></div></li>
<li><p>This <strong>right (outer) join</strong> matches everything that
is in the right table and not in the left table:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">right</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color <span class="kw">where</span> a.<span class="kw">id</span> <span class="kw">is</span> <span class="kw">null</span>;</span></code></pre></div></li>
<li><p>A <strong>full (outer) join</strong> merges both tables:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">full</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color;</span></code></pre></div></li>
<li><p>This <strong>full (outer) join</strong> merges both tables and
removes those rows which are in both:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> a.<span class="kw">id</span> <span class="kw">as</span> id_a, a.color <span class="kw">as</span> color_a, b.<span class="kw">id</span> <span class="kw">as</span> id_b, b.color <span class="kw">as</span> color_b <span class="kw">from</span> palette_a a <span class="kw">full</span> <span class="kw">join</span> palette_b b <span class="kw">on</span> a.color <span class="op">=</span> b.color <span class="kw">where</span> a.<span class="kw">id</span> <span class="kw">is</span> <span class="kw">null</span> <span class="kw">or</span> b.<span class="kw">id</span> <span class="kw">is</span> <span class="kw">null</span>;</span></code></pre></div></li>
<li><p>In addition to the on keyword you can also use the using keyword
if the PK and FK are the same:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> orders <span class="kw">inner</span> <span class="kw">join</span> order_items <span class="kw">using</span>(order_id)</span></code></pre></div></li>
<li><p>You can also use multiple on or using statements:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> orders <span class="kw">inner</span> <span class="kw">join</span> order_items <span class="kw">using</span>(order_id) <span class="kw">inner</span> <span class="kw">join</span> customers <span class="kw">using</span>(customer_id)</span></code></pre></div></li>
<li><p>If you use the on keyword, use <code>and</code> for
multiples!</p></li>
<li><p>You can also create the Cartesian product:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> products <span class="kw">cross</span> <span class="kw">join</span> warehouse;</span></code></pre></div></li>
<li><p>It is also possible to do a self join:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> (w.first_name <span class="op">||</span> <span class="st">&#39; &#39;</span> <span class="op">||</span> w.last_name) <span class="ot">&quot;Worker&quot;</span>, (m.first_name <span class="op">||</span> <span class="st">&#39; &#39;</span> <span class="op">||</span> m.last_name) <span class="ot">&quot;Manager&quot;</span>, w.job_title <span class="kw">from</span> employees w <span class="kw">left</span> <span class="kw">join</span> employees m <span class="kw">on</span> w.employee_id <span class="op">=</span> m.manager_id</span></code></pre></div></li>
<li><p>What is the difference between <code>join</code> and
<code>union</code>? <code>join</code> merges horizontally (there are
more columns than before, maybe also more rows), <code>union</code>
merges vertically (there are more rows than before, but the column count
stays the same).</p></li>
<li><p><code>union</code> is similar to <code>T1 | T2</code> in
TypeScript; you can use order by and union to remove duplicates, but
note that we have to use select two times:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> first_name, last_name, email, <span class="st">&#39;contact&#39;</span> <span class="kw">as</span> <span class="kw">role</span> <span class="kw">from</span> contacts <span class="kw">union</span> <span class="kw">select</span> first_name, last_name, email, <span class="st">&#39;employee&#39;</span> <span class="kw">as</span> <span class="kw">role</span> <span class="kw">from</span> employees <span class="kw">order</span> <span class="kw">by</span> <span class="kw">role</span></span></code></pre></div></li>
<li><p><code>union all</code> is similar to <code>T1 &amp; T2</code> in
TypeScript; it keeps duplicates:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> last_name <span class="kw">from</span> contacts <span class="kw">union</span> <span class="kw">all</span> <span class="kw">select</span> last_name <span class="kw">from</span> employees;</span></code></pre></div></li>
<li><p>Wish to find the difference between two tables? Use
<code>intersect</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> last_name <span class="kw">from</span> contacts <span class="kw">intersect</span> <span class="kw">select</span> last_name <span class="kw">from</span> employees;</span></code></pre></div></li>
<li><p>Wish to subtract one table from another table? Use
<code>minus</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> last_name <span class="kw">from</span> contacts <span class="kw">minus</span> <span class="kw">select</span> last_name <span class="kw">from</span> employees;</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.3" id="aliases"><span class="header-section-number">1.3.3</span> Aliases</h3>
<ul>
<li><p>You can alias long column names with
<code>select mylongname as name from contacts</code> or just
<code>select mylongname name from contacts</code>. The <code>as</code>
keyword is optional. Full-text column names are supported by enclosing
in ““. as can also format strings:
<code>select first_name || &#39; &#39; || last_name as &quot;Name&quot; from employees;</code>
yields Alice, Bob and System.</p></li>
<li><p>You can also create a table alias (using
<code>from employees e</code>), but you CAN’T USE the <code>as</code>
keyword.</p></li>
</ul>
<h3 data-number="1.3.4" id="limits-and-pagination"><span class="header-section-number">1.3.4</span> Limits and Pagination</h3>
<ul>
<li><p>The Oracle equivalent of filter is
<code>fetch n next rows only</code>:
<code>select * from products order by list_price desc fetch next 5 rows only;</code>.</p></li>
<li><p>You may also use the
<code>fetch next n percent rows only</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> inventories <span class="kw">order</span> <span class="kw">by</span> quantity <span class="kw">desc</span> fetch <span class="kw">next</span> <span class="dv">10</span> <span class="kw">percent</span> <span class="kw">rows</span> <span class="kw">only</span>;</span></code></pre></div></li>
<li><p>Filtering by for example a quantity, and you only want the first
10 “condition matches”? Use
<code>fetch n next rows with ties</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> inventories <span class="kw">order</span> <span class="kw">by</span> quantity <span class="kw">desc</span> fetch <span class="kw">next</span> <span class="dv">5</span> <span class="kw">rows</span> <span class="kw">with</span> ties;</span></code></pre></div></li>
<li><p>Need Pagination? Use offset:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> products <span class="kw">order</span> <span class="kw">by</span> standard_cost <span class="kw">desc</span> offset <span class="dv">10</span> <span class="kw">rows</span> fetch <span class="kw">next</span> <span class="dv">10</span> <span class="kw">rows</span> <span class="kw">only</span>;.</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.5" id="dates-and-intervals"><span class="header-section-number">1.3.5</span> Dates and Intervals</h3>
<ul>
<li><p>Want to extract a year from a date? Use <code>extract</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> orders <span class="kw">where</span> status <span class="op">=</span> <span class="st">&#39;Shipped&#39;</span> <span class="kw">and</span> <span class="fu">extract</span>(<span class="dt">year</span> <span class="kw">from</span> order_date) <span class="op">=</span> <span class="dv">2017</span> <span class="kw">order</span> <span class="kw">by</span> order_date <span class="kw">desc</span> fetch <span class="kw">next</span> <span class="dv">1</span> <span class="kw">rows</span> <span class="kw">with</span> ties;</span></code></pre></div></li>
<li><p>Want to get the current date? Use <code>current_date</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">current_date</span> <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>The <code>to_char</code> function can convert dates (and
timestamps) to chars:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">to_char</span>(<span class="fu">sysdate</span>, <span class="st">&#39;YYYY-MM-DD&#39;</span>) <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>The <code>to_date</code> function can convert chars to dates:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">to_date</span>(<span class="st">&#39;2021-01-12&#39;</span>, <span class="st">&#39;YYYY-MM-DD&#39;</span>) <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>Alternatively, the date literal uses the <code>YYYY-MM-DD</code>
format and does not require format specs:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="dt">date</span> <span class="st">&#39;1969-04-20&#39;</span> <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>You can get the current date with <code>sysdate</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">localtimestamp</span> <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>You can get the current date &amp; time with
<code>datelocaltimestamp</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">localtimestamp</span> <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>The current time zone is available with
<code>sessiontimezone</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">sessiontimezone</span> <span class="kw">from</span> dual (yields Europe<span class="op">/</span>Berlin);</span></code></pre></div></li>
<li><p>The <code>timestamp</code> literal uses the
<code>YYYY-MM-DD HH24:MI:SS.FF</code> format:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="dt">timestamp</span> <span class="st">&#39;1969-04-20 00:00:00.00&#39;</span> <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>You may also append the timezone (But keep in mind that timestamp
with time zone is the column type in this case):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="dt">timestamp</span> <span class="st">&#39;1969-04-20 00:00:00.00 Europe/Berlin&#39;</span> <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>The <code>interval</code> literal can be used to create
intervals:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="dt">interval</span> <span class="st">&#39;9&#39;</span> <span class="dt">day</span> <span class="kw">from</span> dual, <span class="kw">select</span> <span class="dt">interval</span> <span class="st">&#39;9&#39;</span> <span class="dt">month</span> <span class="kw">from</span> dual, <span class="kw">select</span> <span class="dt">interval</span> <span class="st">&#39;9-2&#39;</span> <span class="dt">year</span> <span class="kw">to</span> <span class="dt">month</span> <span class="kw">from</span> dual <span class="kw">or</span> <span class="kw">select</span> <span class="dt">interval</span> <span class="st">&#39;09:08:6.75&#39;</span> <span class="kw">hour</span> <span class="kw">to</span> <span class="dt">second</span>(<span class="dv">2</span>) <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>Using the <code>months_between</code> function, the count of
months between two dates can be computed.</p></li>
</ul>
<h3 data-number="1.3.6" id="expressions"><span class="header-section-number">1.3.6</span> Expressions</h3>
<ul>
<li>Only single quotes are supported.</li>
<li>Comparisons are done with <code>=</code>, NOT <code>==</code>.</li>
<li>It also supports full expression evaluation:</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> product_name <span class="kw">as</span> <span class="ot">&quot;Product Name&quot;</span>, list_price <span class="op">-</span> standard_cost <span class="kw">as</span> <span class="ot">&quot;Gross Profit&quot;</span> <span class="kw">from</span> products <span class="kw">order</span> <span class="kw">by</span> <span class="ot">&quot;Gross Profit&quot;</span></span></code></pre></div>
<ul>
<li><p>You can use <code>()</code> in <code>where</code> clauses to
prioritize:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> orders <span class="kw">where</span> (</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>status <span class="op">=</span> <span class="st">&#39;Canceled&#39;</span> <span class="kw">or</span> status <span class="op">=</span> <span class="st">&#39;Pending&#39;</span> ) <span class="kw">and</span> customer_id <span class="op">=</span> <span class="dv">44</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> order_date;</span></code></pre></div></li>
<li><p>The <code>in</code> keyword is a useful tool for sub collections
and subqueries:</p>
<ul>
<li><code>select * from orders where salesman_id in (54, 55, 56) order by order_id;</code></li>
<li><code>select * from orders where salesman_id not in (54, 55, 56) order by order_id; (you can use not)</code></li>
<li><code>select * from employees where employee_id in ( select distinct salesman_id from orders where status = &#39;Canceled&#39; ) order by first_name;</code>
(you can of course also use not)</li>
</ul></li>
<li><p><code>between</code> can also be used for dates:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> orders <span class="kw">where</span> order_date <span class="kw">between</span> <span class="dt">date</span> <span class="st">&#39;2016-12-01&#39;</span> <span class="kw">and</span> <span class="dt">date</span> <span class="st">&#39;2016-12-31&#39;</span></span></code></pre></div></li>
<li><p><code>... like &#39;%Asus%&#39;</code> (note the &#39;s) is basically a
full-text search.</p></li>
<li><p>Some examples of <code>like</code> (you can use <code>not</code>
for all of them):</p>
<ul>
<li><code>select * from contacts where last_name like &#39;St%&#39;</code></li>
<li><code>select * from contacts where last_name like &#39;%St&#39;</code></li>
<li><code>select * from contacts where last_name like &#39;%St%&#39;</code></li>
<li><code>select * from contacts where last_name like &#39;Po_tinger&#39;</code>
(<code>_</code> matches any one character)</li>
<li><code>select * from contacts where lower(last_name) like &#39;st%&#39;</code></li>
<li><code>select * from contacts where upper(last_name) like &#39;st%&#39;</code></li>
<li><code>select * from discounts where discount_message like &#39;%%%&#39;</code>
(returns everything)</li>
<li><code>select * from discounts where discount_message like &#39;%%%&#39; escape &#39;!&#39;</code>
(returns everything that includes the string ‘%’)</li>
</ul></li>
<li><p>You can compare against null with <code>is null</code>
(<code>= NULL</code> does not work). You can negate with
<code>not</code>.</p></li>
</ul>
<h3 data-number="1.3.7" id="grouping-and-ordering"><span class="header-section-number">1.3.7</span> Grouping and Ordering</h3>
<ul>
<li><p>You can use functions like <code>upper</code> and dates when
ordering.</p></li>
<li><p>The <code>group by</code> keyword can be used to find unique
data:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> status <span class="kw">from</span> orders <span class="kw">group</span> <span class="kw">by</span> status;</span></code></pre></div></li>
<li><p>By combining <code>group by</code> with <code>count</code> you
can count the amount of unique data:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> status, <span class="fu">count</span> (<span class="op">*</span>) <span class="kw">from</span> orders <span class="kw">group</span> <span class="kw">by</span> status;</span></code></pre></div></li>
<li><p><code>group by</code> can also be used with the
<code>where</code> keyword:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> name, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> <span class="ot">&quot;Shipped Orders&quot;</span> <span class="kw">from</span> orders <span class="kw">inner</span> <span class="kw">join</span> customers <span class="kw">using</span>(customer_id) <span class="kw">where</span> status <span class="op">=</span> <span class="st">&#39;Shipped&#39;</span> <span class="kw">group</span> <span class="kw">by</span> name <span class="kw">order</span> <span class="kw">by</span> <span class="ot">&quot;Shipped Orders&quot;</span> <span class="kw">desc</span>;</span></code></pre></div></li>
<li><p><code>where</code> can NOT APPEAR AFTER <code>group by</code>;
use the having keyword instead.</p></li>
<li><p>The <code>having</code> keyword enables you to filter like with
<code>where</code>, but after the <code>group by</code> keyword like
so:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> status <span class="kw">from</span> orders <span class="kw">where</span> <span class="fu">extract</span>(<span class="dt">year</span> <span class="kw">from</span> order_date) <span class="op">&gt;</span> <span class="st">&#39;2016&#39;</span> <span class="kw">group</span> <span class="kw">by</span> status <span class="kw">having</span> status <span class="kw">like</span> <span class="st">&#39;%d&#39;</span>;</span></code></pre></div></li>
<li><p>Multiple order by statements? First ordered by first statement,
then “sub-ordered” by the second (last name the same -&gt; now first
name is evaluated).</p></li>
<li><p>Want to have nulls first when ordering? Use nulls first or nulls
last as the suffix.</p></li>
<li><p>Removal of duplicates is done with <code>select distinct</code>.
When multiple columns are being selected, use only one distinct keyword
at the start. Multiple nulls are filtered (Null = Null).</p></li>
</ul>
<h3 data-number="1.3.8" id="counting-and-sums"><span class="header-section-number">1.3.8</span> Counting and Sums</h3>
<ul>
<li><p>You can count the amount of rows with the <code>count()</code>
function:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> products</span></code></pre></div></li>
<li><p>The <code>sum</code> function can be used to calculate a
total:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">sum</span>(unit_price <span class="op">*</span> quantity) <span class="kw">from</span> order_items;</span></code></pre></div></li>
<li><p>It can also be used to calculate a total per row (the group by
<code>order_id</code> part is required;
<code>group by order_value</code> does not work):</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> order_id, <span class="fu">sum</span>(unit_price <span class="op">*</span> quantity) <span class="kw">as</span> order_value <span class="kw">from</span> order_items <span class="kw">group</span> <span class="kw">by</span> order_id;</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.9" id="inserting"><span class="header-section-number">1.3.9</span> Inserting</h3>
<ul>
<li><p>It is a good idea to always specify the columns when
inserting:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> discounts(discount_name, amount, start_date, expired_date) <span class="kw">values</span> (<span class="st">&#39;Summer Promotion&#39;</span>, <span class="fl">9.5</span>, <span class="dt">date</span> <span class="st">&#39;2017-05-01&#39;</span>, <span class="dt">date</span> <span class="st">&#39;2017-08-31&#39;</span>)</span></code></pre></div></li>
<li><p>You can also “insert from select” using
<code>insert into</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> sales(customer_id, product_id, order_date, total) <span class="kw">select</span> customer_id, product_id, order_date, <span class="fu">sum</span>(quantity <span class="op">*</span> unit_price) amount <span class="kw">from</span> orders <span class="kw">inner</span> <span class="kw">join</span> order_items <span class="kw">using</span>(order_id) <span class="kw">where</span> status <span class="op">=</span> <span class="st">&#39;Shipped&#39;</span> <span class="kw">group</span> <span class="kw">by</span> customer_id, product_id, order_date;</span></code></pre></div></li>
<li><p>It’s even possible to “create a table from select” using
<code>create table x as</code>, basically coping its schema
(<code>where 1 = 0 skips</code> copying the rows):</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> sales_2017 <span class="kw">as</span> <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> sales <span class="kw">where</span> <span class="dv">1</span> <span class="op">=</span> <span class="dv">0</span>;</span></code></pre></div></li>
<li><p>Using insert all, it is possible to insert multiple rows at once
(note the lack of commas between the into keywords. Here, the subquery
is ignored/a placeholder.):</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">all</span> <span class="kw">into</span> fruits (fruit_name, color) <span class="kw">values</span> (<span class="st">&#39;Apple&#39;</span>, <span class="st">&#39;Red&#39;</span>) <span class="kw">into</span> fruits (fruit_name, color) <span class="kw">values</span> (<span class="st">&#39;Orange&#39;</span>, <span class="st">&#39;Orange&#39;</span>) <span class="kw">into</span> fruits (fruit_name, color) <span class="kw">values</span> (<span class="st">&#39;Banana&#39;</span>, <span class="st">&#39;Yellow&#39;</span>) <span class="kw">select</span> <span class="dv">1</span> <span class="kw">from</span> dual</span></code></pre></div></li>
<li><p>You can also use conditions based on the subquery
(<code>insert first</code> is the equivalent of a switch case.):</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">all</span> <span class="cf">when</span> amount <span class="op">&lt;</span> <span class="dv">10000</span> <span class="cf">then</span> <span class="kw">into</span> small_orders <span class="cf">when</span> amount <span class="op">&gt;=</span> <span class="dv">10000</span> <span class="cf">then</span> <span class="kw">into</span> big_orders <span class="kw">select</span> order_id, customer_id, (quantity <span class="op">*</span> unit_price) amount <span class="kw">from</span> orders <span class="kw">inner</span> <span class="kw">join</span> order_items <span class="kw">using</span> (order_id)</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.10" id="switches"><span class="header-section-number">1.3.10</span> Switches</h3>
<ul>
<li><p>Using <code>case</code> it is possible to create if/else
constructs:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> product_name, list_price, <span class="cf">case</span> category_id <span class="cf">when</span> <span class="dv">1</span> <span class="cf">then</span> <span class="fu">round</span>(list_price <span class="op">*</span> <span class="fl">0.05</span>, <span class="dv">2</span>) <span class="cf">when</span> <span class="dv">2</span> <span class="cf">then</span> <span class="fu">round</span>(list_price <span class="op">*</span> <span class="fl">0.1</span>, <span class="dv">2</span>) <span class="cf">else</span> <span class="fu">round</span>(list_price <span class="op">*</span> <span class="fl">0.2</span>, <span class="dv">2</span>) <span class="cf">end</span> discount <span class="kw">from</span> products</span></code></pre></div></li>
<li><p><code>case</code> is also useful for conditional grouping:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> locations <span class="kw">order</span> <span class="kw">by</span> country_id, <span class="cf">case</span> country_id <span class="cf">when</span> <span class="st">&#39;US&#39;</span> <span class="cf">then</span> state <span class="cf">else</span> city <span class="cf">end</span>;</span></code></pre></div></li>
<li><p><code>case</code> also evaluates to an expression, so you can use
it for conditional updates:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> products <span class="kw">set</span> list_price <span class="op">=</span> <span class="cf">case</span> <span class="cf">when</span> list_price <span class="op">&lt;</span> <span class="dv">20</span> <span class="cf">then</span> <span class="dv">30</span> <span class="cf">else</span> <span class="dv">50</span> <span class="cf">end</span> <span class="kw">where</span> list_price <span class="op">&lt;</span> <span class="dv">50</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.11" id="helper-functions"><span class="header-section-number">1.3.11</span> Helper Functions</h3>
<ul>
<li><p>You can extract substrings with <code>substr</code>:
<code>select substr(&#39;Alex&#39;, 1, 1) from dual;</code></p></li>
<li><p>Stuff like <code>select upper(&#39;uwu&#39;) from dual</code> can come in
handy.</p></li>
<li><p>Using <code>round</code> it is possible to round numbers (returns
5.23):</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">round</span>(<span class="fl">5.234234234234</span>, <span class="dv">2</span>) <span class="kw">from</span> dual;</span></code></pre></div></li>
<li><p>You can use <code>replace</code> to replace strings:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> accounts <span class="kw">set</span> phone <span class="op">=</span> <span class="kw">replace</span>(phone, <span class="st">&#39;+1-&#39;</span>, <span class="st">&#39;&#39;</span>);</span></code></pre></div></li>
<li><p>You can use the <code>floor</code>, <code>round</code> and
<code>ceil</code> functions to get rounded values.</p></li>
</ul>
<h3 data-number="1.3.12" id="auto-generated-primary-keys"><span class="header-section-number">1.3.12</span> Auto-Generated Primary
Keys</h3>
<ul>
<li><p><code>generated by default as identity</code> is quite useful for
auto-incrementing columns such as PKs:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> persons ( person_id <span class="dt">number</span> <span class="kw">generated</span> <span class="kw">by</span> <span class="kw">default</span> <span class="kw">as</span> identity, first_name <span class="dt">varchar2</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>, last_name <span class="dt">varchar2</span>(<span class="dv">50</span>), <span class="kw">primary</span> <span class="kw">key</span>(person_id) );</span></code></pre></div></li>
<li><p><code>generated always as identity</code> is the same but does
not allow setting it manually.</p></li>
</ul>
<h3 data-number="1.3.13" id="modifying-columns"><span class="header-section-number">1.3.13</span> Modifying Columns</h3>
<ul>
<li><p>You can use <code>desc mytable</code> to show the schema for a
table.</p></li>
<li><p><code>alter table</code> can be used to add columns using
add:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">add</span> birthdate <span class="dt">date</span> <span class="kw">not</span> <span class="kw">null</span>;</span></code></pre></div></li>
<li><p>You can also add multiples at once (note that there is no column
keyword):</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">add</span> ( phone <span class="dt">varchar2</span>(<span class="dv">20</span>), email <span class="dt">varchar2</span>(<span class="dv">100</span>) )</span></code></pre></div></li>
<li><p><code>modify</code> can change the column type (note that there
is no column keyword):</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">modify</span> birthdate <span class="dt">date</span> <span class="kw">null</span>;</span></code></pre></div></li>
<li><p><code>drop column</code> can be used to remove a column</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">drop</span> <span class="kw">column</span> birthdate;</span></code></pre></div></li>
<li><p><code>rename column</code> can be used to rename a column:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">rename</span> <span class="kw">column</span> first_name <span class="kw">to</span> forename;</span></code></pre></div></li>
<li><p><code>rename to</code> can be used to rename a table:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">rename</span> <span class="kw">to</span> people;</span></code></pre></div></li>
<li><p><code>rename promotions to promotions_two</code> is an
alternative syntax.</p></li>
<li><p>You can use the default keyword to set a default value:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> accounts <span class="kw">add</span> status <span class="dt">number</span>(<span class="dv">1</span>,<span class="dv">0</span>) <span class="kw">default</span> <span class="dv">1</span> <span class="kw">not</span> <span class="kw">null</span>.</span></code></pre></div></li>
<li><p>A more efficient logical version of drop column is set unused
column:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> suppliers <span class="kw">set</span> <span class="kw">unused</span> <span class="kw">column</span> fax;</span></code></pre></div></li>
<li><p>You can now drop it using:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> suppliers <span class="kw">drop</span> <span class="kw">unused</span> <span class="kw">columns</span>;</span></code></pre></div></li>
<li><p>If you want to physically drop a column, use
<code>drop</code>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> suppliers <span class="kw">drop</span> (email, phone);</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.14" id="virtual-columns"><span class="header-section-number">1.3.14</span> Virtual Columns</h3>
<ul>
<li><p>You can create virtual columns in regular tables without using
views with <code>alter table x add ... as</code> (note the required
<code>(</code> after the <code>as</code> keyword):</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> parts <span class="kw">add</span> (capacity_description <span class="kw">as</span> ( <span class="cf">case</span> <span class="cf">when</span> capacity <span class="op">&lt;=</span> <span class="dv">8</span> <span class="cf">then</span> <span class="st">&#39;Small&#39;</span> <span class="cf">when</span> capacity <span class="op">&gt;</span> <span class="dv">8</span> <span class="cf">then</span> <span class="st">&#39;Large&#39;</span> <span class="cf">end</span> ));</span></code></pre></div></li>
<li><p>The size of a <code>varchar2</code> is adjustable afterwards
(note that this checks if any current <code>varchar2</code>s are larger
than the new size and fails if they are.):</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> persons <span class="kw">modify</span> first_name <span class="dt">varchar2</span>(<span class="dv">255</span>);</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.15" id="modifying-tables"><span class="header-section-number">1.3.15</span> Modifying Tables</h3>
<ul>
<li><p>You can drop a table with <code>drop table</code>:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> people;</span></code></pre></div></li>
<li><p>Appending <code>purge</code> clears the recycle bin; appending
<code>cascade constraints</code> drop all related constraints.</p></li>
<li><p>You can clear a table using <code>truncate table</code>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">truncate</span> <span class="kw">table</span> customers_copy;</span></code></pre></div></li>
<li><p>The same limitations as with drop table concerning constraints
apply, so appending cascade (WITHOUT constraints) drops all related
ones.</p></li>
<li><p>You can clear the recycle bin with:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">purge</span> recyclebin;</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.16" id="constraints"><span class="header-section-number">1.3.16</span> Constraints</h3>
<ul>
<li><p>It is possible to add constraints (any constraints, a primary key
in this example) after creating a table with add constraint:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> purchase_orders <span class="kw">add</span> <span class="kw">constraint</span> purchase_orders_order_id_pk <span class="kw">primary</span> <span class="kw">key</span>(order_id);</span></code></pre></div></li>
<li><p>You may remove a constraint with
<code>drop constraint</code>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> purchase_orders <span class="kw">drop</span> <span class="kw">constraint</span> purchase_orders_order_id_pk;</span></code></pre></div></li>
<li><p>Instead of removing it, you can also use
<code>disable constraint</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> purchase_orders <span class="kw">disable</span> <span class="kw">constraint</span> purchase_orders_order_id_pk;</span></code></pre></div></li>
<li><p>And re-enable it with <code>enable constraint</code>:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> purchase_orders <span class="kw">enable</span> <span class="kw">constraint</span> purchase_orders_order_id_pk;</span></code></pre></div></li>
<li><p>You can also add foreign key constraints:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> suppliers <span class="kw">add</span> <span class="kw">constraint</span> suppliers_supplier_groups_fk <span class="kw">foreign</span> <span class="kw">key</span>(<span class="fu">group_id</span>) <span class="kw">references</span> supplier_groups(<span class="fu">group_id</span>);</span></code></pre></div></li>
<li><p>Using a check constraint, arbitrary expressions can be
evaluated:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> parts <span class="kw">add</span> <span class="kw">constraint</span> check_buy_price_positive <span class="kw">check</span>(buy_price <span class="op">&gt;</span> <span class="dv">0</span>);</span></code></pre></div></li>
<li><p>A unique constraint prevents unwanted duplicates:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> clients <span class="kw">add</span> <span class="kw">constraint</span> unique_clients_phone <span class="kw">unique</span>(phone);</span></code></pre></div></li>
<li><p>With a not null constraint, fuzzy logic can be avoided; it is
however best to define nullable fields at schema creation, as the syntax
differs from the add constraint/drop constraint logic above:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> clients <span class="kw">modify</span> ( <span class="dv">7</span> phone <span class="kw">not</span> <span class="kw">null</span> );</span></code></pre></div></li>
<li><p>You can remove them by modifying it to null explicitly:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> clients <span class="kw">modify</span> ( phone <span class="kw">null</span> );</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.17" id="types"><span class="header-section-number">1.3.17</span> Types</h3>
<ul>
<li>You can create a number within a range:
<code>number(1,0)</code>.</li>
<li>The <code>number</code> type is used for all types of numbers by
specifying precision and scale: <code>number(6)</code> (or
<code>number(6,0)</code>) is a signed integer fitting 6 digits,
<code>number(6,2)</code> is a float with two digits precision. The DB
doesn’t just cut of numbers, it rounds them.</li>
<li>The float type can be emulated by the number type,
i.e. <code>float(2)</code> is equal to <code>number(38,2)</code>. The
argument is in bits instead of digits though.</li>
<li>The <code>lengthdb</code> function can be used to get the length of
field in bytes.</li>
<li>The char type has a fixed length: name <code>char(10)</code> or name
<code>char(10 bytes)</code>, meaning that a char always takes up the
amount of bytes set. <code>nchar</code> is the same but UTF-8 or UTF-16
any doesn’t take bytes.</li>
<li>The <code>varchar2</code> type also takes an argument for the length
in bytes, which in ASCII corresponds to the amount of characters.
<code>nvarchar2</code> is the same but UTF-8 or UTF-16 and doesn’t take
bytes.</li>
</ul>
<h3 data-number="1.3.18" id="views"><span class="header-section-number">1.3.18</span> Views</h3>
<ul>
<li><p>You can create a view with
<code>create view x as select ...</code>:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">view</span> employees_years_of_service <span class="kw">as</span> <span class="kw">select</span> employee_id, first_name <span class="op">||</span> <span class="st">&#39; &#39;</span> <span class="op">||</span> last_name <span class="kw">as</span> full_name, <span class="fu">floor</span>(<span class="fu">months_between</span>(<span class="fu">current_date</span>, hire_date) <span class="op">/</span> <span class="dv">12</span>) <span class="kw">as</span> years_of_service <span class="kw">from</span> employees;</span></code></pre></div></li>
<li><p>If used with <code>create or replace view</code>, upserts are
possible.</p></li>
<li><p>By appending <code>with read only</code>, you can prevent data
modifications:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">view</span> employees_years_of_service <span class="kw">as</span> <span class="kw">select</span> employee_id, first_name <span class="op">||</span> <span class="st">&#39; &#39;</span> <span class="op">||</span> last_name <span class="kw">as</span> full_name, <span class="fu">floor</span>(<span class="fu">months_between</span>(<span class="fu">current_date</span>, hire_date) <span class="op">/</span> <span class="dv">12</span>) <span class="kw">as</span> years_of_service <span class="kw">from</span> employees <span class="kw">with</span> <span class="kw">read</span> <span class="kw">only</span>;</span></code></pre></div></li>
<li><p><code>drop view x</code> removes the view.</p></li>
<li><p>Deletions and updates on views are usually fine, but inserts can
often be not that useful due to fields being excluded from the view; see
<code>instead of</code> triggers later on for a solution;</p></li>
<li><p>Subqueries can be used in selects:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> ( <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> products) <span class="kw">where</span> list_price <span class="op">&lt;</span> <span class="dv">100</span>;</span></code></pre></div></li>
<li><p>They can also be used in updates:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">update</span> ( <span class="kw">select</span> list_price <span class="kw">from</span> products ) <span class="kw">set</span> list_price <span class="op">=</span> list_price <span class="op">*</span> <span class="fl">1.5</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.3.19" id="indexes"><span class="header-section-number">1.3.19</span> Indexes</h3>
<ul>
<li><p>You can create an index with <code>create index</code>:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">index</span> members_last_name <span class="kw">on</span> members(last_name);</span></code></pre></div></li>
<li><p>You can also create an index spanning multiple columns:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">index</span> members_full_name <span class="kw">on</span> members(first_name, last_name);</span></code></pre></div></li>
<li><p>You can drop an index with <code>drop index</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">index</span> members_full_name;</span></code></pre></div></li>
</ul>
<h2 data-number="1.4" id="plsql"><span class="header-section-number">1.4</span> PL/SQL</h2>
<h3 data-number="1.4.1" id="block-structure"><span class="header-section-number">1.4.1</span> Block Structure</h3>
<ul>
<li><p>Block structure:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- declarations</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- your logic</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="kw">exception</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- exception handling</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>The most simple example is as follows:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>   dbms_output.put_line(<span class="st">&#39;Hello World!&#39;</span>);</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Use <code>put_line</code> from the <code>dmbs_output</code>
package to print to stdout.</p></li>
<li><p>You can use the declare section for variables:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    message <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="op">:=</span> <span class="st">&#39;Hello, World!&#39;</span>;</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(message);</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>The <code>exception</code> block is used to handle exceptions,
for example <code>zero_divide</code> for divisions by zero
(<code>when others then</code> handles unexpected other exceptions):</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    result <span class="dt">number</span>;</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    result <span class="op">:=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">0</span>;</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">exception</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> zero_divide <span class="cf">then</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>            dbms_output.put_line(sqlerrm);</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> others <span class="cf">then</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>            dbms_output.put_line(<span class="st">&#39;An unexpected error occured: &#39;</span> <span class="op">||</span> sqlerrm);</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You always have to specify an execution section; use
<code>null</code> for a no-op:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">null</span>;</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can use <code>--</code> for single line comments and
<code>/*</code> for multi line comments.</p></li>
</ul>
<h3 data-number="1.4.2" id="variables"><span class="header-section-number">1.4.2</span> Variables</h3>
<ul>
<li><p>PL/SQL extends SQL by adding a boolean type (which can have the
values true, false and null).</p></li>
<li><p>Variables need not be given a value at declaration if they are
nullable:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    total_sales <span class="dt">number</span>(<span class="dv">15</span>,<span class="dv">2</span>);</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    credit_limit <span class="dt">number</span>(<span class="dv">10</span>,<span class="dv">0</span>);</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    contact_name <span class="dt">varchar2</span>(<span class="dv">255</span>);</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">null</span>;</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can use <code>default</code> as an alternative to the
<code>:=</code> operator when assigning variables in the declaration
section. DO NOT use <code>=</code> when assignment, even re-assignment
also uses <code>:=</code>.</p></li>
<li><p>If a variable is defined as not null, it can’t take a string of
length 0:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    shipping_status <span class="dt">varchar2</span>(<span class="dv">25</span>) <span class="kw">not</span> <span class="kw">null</span> <span class="op">:=</span> <span class="st">&#39;shipped&#39;</span>;</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    shipping_status <span class="op">:=</span> <span class="st">&#39;&#39;</span>; <span class="co">-- You need to specify any string != &#39;&#39;</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Constants are created with the <code>constant</code> keyword and
forbid reassignment:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    price <span class="kw">constant</span> <span class="dt">number</span> <span class="op">:=</span> <span class="dv">10</span>;</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    price <span class="op">:=</span> <span class="dv">20</span>; <span class="co">-- Will throw an exception</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.3" id="fetching-data"><span class="header-section-number">1.4.3</span> Fetching Data</h3>
<ul>
<li><p>Use <code>select ... into</code> to fetch data into variables;
<code>%TYPE</code> infers the type of a column:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    customer_name customers.name<span class="dt">%TYPE</span>;</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    customer_credit_limit customers.credit_limit<span class="dt">%TYPE</span>;</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>        name, credit_limit</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">into</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>        customer_name, customer_credit_limit</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> customers <span class="kw">where</span> customer_id <span class="op">=</span> <span class="dv">38</span>;</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(customer_name <span class="op">||</span> <span class="st">&#39;: &#39;</span> <span class="op">||</span> customer_credit_limit);</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.4" id="branches-and-expressions"><span class="header-section-number">1.4.4</span> Branches and Expressions</h3>
<ul>
<li><p><code>if ... then ... end if</code> can be used for
branching:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    sales <span class="dt">number</span> <span class="op">:=</span> <span class="dv">20000</span>;</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sales <span class="op">&gt;</span> <span class="dv">10000</span> <span class="cf">then</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(<span class="st">&#39;Lots of sales!&#39;</span>);</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Inline expressions are also supported:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>large_sales <span class="op">:=</span> sales <span class="op">&gt;</span> <span class="dv">10000</span></span></code></pre></div></li>
<li><p>Booleans need not be compared with <code>my_bool = true</code>, a
simple <code>if my_bool then</code> is fine.</p></li>
<li><p><code>elseif ... then</code> is NOT valid syntax;
<code>elsif ... then</code> is valid syntax.</p></li>
<li><p>Statements may also be nested:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    sales <span class="dt">number</span> <span class="op">:=</span> <span class="dv">20000</span>;</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sales <span class="op">&gt;</span> <span class="dv">10000</span> <span class="cf">then</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> sales <span class="op">&gt;</span> <span class="dv">15000</span> <span class="cf">then</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>            dbms_output.put_line(<span class="st">&#39;A new sales record!&#39;</span>);</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>            dbms_output.put_line(<span class="st">&#39;Lots of sales!&#39;</span>);</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.5" id="switches-1"><span class="header-section-number">1.4.5</span> Switches</h3>
<ul>
<li><p>You may use the <code>case</code> keyword for switch cases:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    grade <span class="dt">char</span>(<span class="dv">1</span>);</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    message <span class="dt">varchar2</span>(<span class="dv">255</span>);</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    grade <span class="op">:=</span> <span class="st">&#39;A&#39;</span>;</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> grade</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">&#39;A&#39;</span> <span class="cf">then</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>            message <span class="op">:=</span> <span class="st">&#39;Excellent&#39;</span>;</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">&#39;B&#39;</span> <span class="cf">then</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>            message <span class="op">:=</span> <span class="st">&#39;Great&#39;</span>;</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">&#39;C&#39;</span> <span class="cf">then</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>            message <span class="op">:=</span> <span class="st">&#39;Good&#39;</span>;</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">&#39;D&#39;</span> <span class="cf">then</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>            message <span class="op">:=</span> <span class="st">&#39;Fair&#39;</span>;</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">&#39;F&#39;</span> <span class="cf">then</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>            message <span class="op">:=</span> <span class="st">&#39;Poor&#39;</span>;</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>            raise case_not_found;</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">case</span>;</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(message);</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.6" id="labels-and-goto"><span class="header-section-number">1.4.6</span> Labels and Goto</h3>
<ul>
<li><p>A <code>label</code>/<code>goto</code> equivalent is also
available:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    goto do_work;</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    goto goodbye;</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span>do_work<span class="op">&gt;&gt;</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;mawahaha&#39;</span>);</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span>goodbye<span class="op">&gt;&gt;</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Goodbye!&#39;</span>);</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.7" id="loops"><span class="header-section-number">1.4.7</span> Loops</h3>
<ul>
<li><p>The equivalent of the <code>while</code> loop is the
<code>loop</code>. <code>exit</code>/<code>continue</code> prevents an
infinite loop:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    i <span class="dt">number</span> <span class="op">:=</span> <span class="dv">0</span>;</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">loop</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>        i <span class="op">:=</span> i <span class="op">+</span> <span class="dv">1</span>;</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(<span class="st">&#39;Iterator: &#39;</span> <span class="op">||</span> i);</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">10</span> <span class="cf">then</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>            exit;</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Done!&#39;</span>);</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>For loops can be done using the
<code>for i in 0..100 loop ... end loop</code> syntax:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="dv">0</span><span class="op">..</span><span class="dv">100</span> <span class="cf">loop</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(i);</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>While loops work as you’d expect; but also require the
<code>loop</code> keyword:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    i <span class="dt">number</span> <span class="op">:=</span> <span class="dv">0</span>;</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&lt;=</span> <span class="dv">100</span> <span class="cf">loop</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(i);</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>        i <span class="op">:=</span> i <span class="op">+</span> <span class="dv">1</span>;</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.8" id="types-and-objects"><span class="header-section-number">1.4.8</span> Types and Objects</h3>
<ul>
<li><p>You can also use <code>%ROWTYPE</code> to infer the type of a row
and select an entire row at once:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    customer customers<span class="dt">%ROWTYPE</span>;</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> <span class="kw">into</span> customer <span class="kw">from</span> customers <span class="kw">where</span> customer_id <span class="op">=</span> <span class="dv">100</span>;</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(customer.name <span class="op">||</span> <span class="st">&#39;/&#39;</span> <span class="op">||</span> customer.website);</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>It is also possible to use OOP-style object/row creation thanks
to <code>%ROWTYPE</code>:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    person persons<span class="dt">%ROWTYPE</span>;</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    person.person_id <span class="op">:=</span> <span class="dv">1</span>;</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    person.first_name <span class="op">:=</span> <span class="st">&#39;John&#39;</span>;</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    person.last_name <span class="op">:=</span> <span class="st">&#39;Doe&#39;</span>;</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">insert</span> <span class="kw">into</span> persons <span class="kw">values</span> person;</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.9" id="exceptions"><span class="header-section-number">1.4.9</span> Exceptions</h3>
<ul>
<li><p>You can create custom exceptions:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    e_credit_too_high <span class="kw">exception</span>;</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    pragma exception_init(e_credit_too_high, <span class="op">-</span><span class="dv">20001</span>);</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">10000</span> <span class="op">&gt;</span> <span class="dv">1000</span> <span class="cf">then</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        raise e_credit_too_high;</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>If you want to raise a custom exception, use
<code>raise_application_error</code>:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    e_credit_too_high <span class="kw">exception</span>;</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    pragma exception_init(e_credit_too_high, <span class="op">-</span><span class="dv">20001</span>);</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    raise_application_error(<span class="op">-</span><span class="dv">20001</span>, <span class="st">&#39;Credit is to high!&#39;</span>);</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Using <code>sqlcode</code> and <code>sqlerrm</code> you can get
the last exception’s code/error message.</p></li>
</ul>
<h3 data-number="1.4.10" id="cursors"><span class="header-section-number">1.4.10</span> Cursors</h3>
<ul>
<li><p>Using cursors, you can procedurally process data:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span> sales_cursor <span class="kw">is</span> <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> sales;</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    sales_record sales_cursor<span class="dt">%ROWTYPE</span>;</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">update</span> customers <span class="kw">set</span> credit_limit <span class="op">=</span> <span class="dv">0</span>;</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">open</span> sales_cursor;</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">loop</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>        fetch sales_cursor <span class="kw">into</span> sales_record;</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>        exit <span class="cf">when</span> sales_cursor<span class="dt">%NOTFOUND</span>;</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">update</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>            customers</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>            credit_limit <span class="op">=</span> <span class="fu">extract</span>(<span class="dt">year</span> <span class="kw">from</span> <span class="fu">sysdate</span>)</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">where</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>            customer_id <span class="op">=</span> sales_record.customer_id;</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">close</span> sales_cursor;</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Complex exit logic can be avoided using the
<code>for ... loop</code>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span> product_cursor <span class="kw">is</span> <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> products;</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> product_record <span class="kw">in</span> product_cursor <span class="cf">loop</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(product_record.product_name <span class="op">||</span> <span class="st">&#39;: $&#39;</span> <span class="op">||</span> product_record.list_price);</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Cursors can also have parameters:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    product_record products<span class="dt">%rowtype</span>;</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>        product_cursor (</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>            low_price <span class="dt">number</span> <span class="op">:=</span> <span class="dv">0</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>            high_price <span class="dt">number</span> <span class="op">:=</span> <span class="dv">100</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">is</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> products <span class="kw">where</span> list_price <span class="kw">between</span> low_price <span class="kw">and</span> high_price;</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">open</span> product_cursor(<span class="dv">50</span>, <span class="dv">100</span>);</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">loop</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>        fetch product_cursor <span class="kw">into</span> product_record;</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>        exit <span class="cf">when</span> product_cursor<span class="dt">%notfound</span>;</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(product_record.product_name <span class="op">||</span> <span class="st">&#39;: $&#39;</span> <span class="op">||</span> product_record.list_price);</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">close</span> product_cursor;</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.11" id="locks"><span class="header-section-number">1.4.11</span> Locks</h3>
<ul>
<li><p>The DB can also lock fields for safe multiple access:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span> customers_cursor <span class="kw">is</span> <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> customers <span class="cf">for</span> <span class="kw">update</span> <span class="kw">of</span> credit_limit;</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> customer_record <span class="kw">in</span> customers_cursor <span class="cf">loop</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">update</span> customers <span class="kw">set</span> credit_limit <span class="op">=</span> <span class="dv">0</span> <span class="kw">where</span> customer_id <span class="op">=</span> customer_record.customer_id;</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.12" id="procedures"><span class="header-section-number">1.4.12</span> Procedures</h3>
<ul>
<li><p>You can create procedures, which are comparable to functions:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">procedure</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    print_contact(customer_id_arg <span class="dt">number</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="kw">is</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    contact_record contacts<span class="dt">%rowtype</span>;</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> <span class="kw">into</span> contact_record <span class="kw">from</span> contacts <span class="kw">where</span> customer_id <span class="op">=</span> customer_id_arg;</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(contact_record.first_name <span class="op">||</span> <span class="st">&#39; &#39;</span> <span class="op">||</span> contact_record.last_name);</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>These procedures can then be executed:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    print_contact(<span class="dv">50</span>);</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Or, without PL/SQL:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">exec</span> print_contact(<span class="dv">50</span>);</span></code></pre></div></li>
<li><p>Once a procedure is no longer needed, it can be removed with
<code>drop procedure</code>:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">procedure</span> print_contact;</span></code></pre></div></li>
<li><p>It is also possible to infer a row type using
<code>sys_refcursor</code> and return rows with
<code>dbms_sql.return_result</code>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">procedure</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    get_customer_by_credit(min_credit <span class="dt">number</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="kw">as</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    customer_cursor sys_refcursor;</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">open</span> customer_cursor <span class="cf">for</span> <span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> customers <span class="kw">where</span> credit_limit <span class="op">&gt;</span> min_credit;</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    dbms_sql.return_result(customer_cursor);</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can now call it:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">exec</span> get_customer_by_credit(<span class="dv">50</span>);</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.13" id="functions"><span class="header-section-number">1.4.13</span> Functions</h3>
<ul>
<li><p>Functions are similar, but require returning a value:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">function</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    get_total_sales_for_year(year_arg <span class="dt">integer</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="kw">return</span> <span class="dt">number</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="kw">is</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    total_sales <span class="dt">number</span> <span class="op">:=</span> <span class="dv">0</span>;</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">sum</span>(unit_price <span class="op">*</span> quantity) <span class="kw">into</span> total_sales</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> order_items</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inner</span> <span class="kw">join</span> orders <span class="kw">using</span> (order_id)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> status <span class="op">=</span> <span class="st">&#39;Shipped&#39;</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> <span class="fu">extract</span>(<span class="dt">year</span> <span class="kw">from</span> order_date)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">having</span> <span class="fu">extract</span>(<span class="dt">year</span> <span class="kw">from</span> order_date) <span class="op">=</span> year_arg;</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> total_sales;</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can call them from PL/SQL:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    total_sales <span class="dt">number</span> <span class="op">:=</span> <span class="dv">0</span>;</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    total_sales <span class="op">:=</span> get_total_sales_for_year(<span class="dv">2017</span>);</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Sales for 2017: &#39;</span> <span class="op">||</span> total_sales);</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>And remove them with <code>drop function</code>:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">function</span> get_total_sales_for_year;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.14" id="packages"><span class="header-section-number">1.4.14</span> Packages</h3>
<ul>
<li><p>Packages can be used to group function “interfaces” and
variables:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">package</span> order_management</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">as</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    shipped_status <span class="kw">constant</span> <span class="dt">varchar</span>(<span class="dv">10</span>) <span class="op">:=</span> <span class="st">&#39;Shipped&#39;</span>;</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    pending_status <span class="kw">constant</span> <span class="dt">varchar</span>(<span class="dv">10</span>) <span class="op">:=</span> <span class="st">&#39;Pending&#39;</span>;</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    cancelled_status <span class="kw">constant</span> <span class="dt">varchar</span>(<span class="dv">10</span>) <span class="op">:=</span> <span class="st">&#39;Canceled&#39;</span>;</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> get_total_transactions <span class="kw">return</span> <span class="dt">number</span>;</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span> order_management;</span></code></pre></div></li>
<li><p>You can now access the variables in the package with
<code>.</code>:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(order_management.shipped_status);</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>In order to use functions in a package, you then have to create a
package body, implementing it:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">package</span> <span class="kw">body</span> order_management</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="kw">as</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> get_total_transactions <span class="kw">return</span> <span class="dt">number</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">is</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>        total_transactions <span class="dt">number</span>;</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">begin</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">select</span> <span class="fu">sum</span>(unit_price) <span class="kw">into</span> total_transactions <span class="kw">from</span> orders <span class="kw">inner</span> <span class="kw">join</span> order_items <span class="kw">using</span>(order_id);</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> total_transactions;</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span>;</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can now access the functions in the package with
<code>.</code>:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    order_management.get_total_transactions() <span class="kw">as</span> total_transactions</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    dual;</span></code></pre></div></li>
<li><p>And the same is possible from PL/SQL:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(order_management.get_total_transactions());</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can drop a package with <code>drop package</code> and a
package body with <code>drop package body</code>:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">package</span> <span class="kw">body</span> order_management;</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">package</span> order_management;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.15" id="triggers"><span class="header-section-number">1.4.15</span> Triggers</h3>
<ul>
<li><p>Triggers follow a similar structure as procedures:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- declarations</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- your logic</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="kw">exception</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- exception handling</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Using triggers, you can for example create a manual log after
operations with <code>after update or delete on ...</code>:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">trigger</span> customers_audit_trigger</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">after</span> <span class="kw">update</span> <span class="kw">or</span> <span class="kw">delete</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">on</span> customers</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="kw">each</span> <span class="kw">row</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    transaction_type <span class="dt">varchar2</span>(<span class="dv">10</span>);</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    transaction_type <span class="op">:=</span> <span class="cf">case</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> updating <span class="cf">then</span> <span class="st">&#39;update&#39;</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> deleting <span class="cf">then</span> <span class="st">&#39;delete&#39;</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span>;</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">insert</span> <span class="kw">into</span> audits(</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>        table_name,</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>        transaction_name,</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>        by_user,</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>        transaction_date</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">values</span> (</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;customers&#39;</span>,</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>        transaction_type,</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">user</span>,</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sysdate</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Thanks to <code>before update of ... on ...</code>, it is also
possible to do more complex checks before inserting:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">trigger</span> customers_credit_trigger</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">before</span> <span class="kw">update</span> <span class="kw">of</span> credit_limit</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">on</span> customers</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    current_day <span class="dt">number</span>;</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    current_day <span class="op">:=</span> <span class="fu">extract</span>(<span class="dt">day</span> <span class="kw">from</span> <span class="fu">sysdate</span>);</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_day <span class="kw">between</span> <span class="dv">28</span> <span class="kw">and</span> <span class="dv">31</span> <span class="cf">then</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>        raise_application_error(<span class="op">-</span><span class="dv">20100</span>, <span class="st">&#39;Locked at the end of the month&#39;</span>);</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>In combination with <code>when</code>, <code>new</code> (not
available in <code>delete</code> statements) and <code>old</code> (not
available in <code>insert</code> statements), it is also possible to
check based on the previous &amp; current values:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">trigger</span> customers_credit_limit_trigger</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">before</span> <span class="kw">update</span> <span class="kw">of</span> credit_limit</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">on</span> customers</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="kw">each</span> <span class="kw">row</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">when</span> (<span class="kw">new</span>.credit_limit <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ch">:new</span>.credit_limit <span class="op">&gt;=</span> <span class="dv">2</span><span class="op">*</span><span class="ch">:old</span>.credit_limit <span class="cf">then</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>        raise_application_error(<span class="op">-</span><span class="dv">20101</span>, <span class="st">&#39;The new credit cannot be more than double the old credit!&#39;</span>);</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">if</span>;</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>Using <code>instead of</code> triggers and
<code>returning ... into ...</code>, you can also use views to safely
insert into multiple tables:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">trigger</span> create_customer_trigger</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">instead</span> <span class="kw">of</span> <span class="kw">insert</span> <span class="kw">on</span> customers_and_contacts</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="kw">each</span> <span class="kw">row</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    current_customer_id <span class="dt">number</span>;</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">insert</span> <span class="kw">into</span> customers(</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>        name,</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>        address,</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>        website,</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>        credit_limit</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">values</span> (</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.name,</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.address,</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.website,</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.credit_limit</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">returning</span> customer_id <span class="kw">into</span> current_customer_id;</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">insert</span> <span class="kw">into</span> contacts(</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>        first_name,</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>        last_name,</span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>        email,</span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>        phone,</span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>        customer_id</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">values</span> (</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.first_name,</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.last_name,</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.email,</span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>        <span class="ch">:new</span>.phone,</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>        current_customer_id</span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can enable/disable a trigger with
<code>alter trigger ... disable/enable</code>:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">trigger</span> create_customer_trigger <span class="kw">disable</span>;</span></code></pre></div></li>
<li><p>And completely remove it with <code>drop trigger</code>:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">trigger</span> create_customer_trigger;</span></code></pre></div></li>
<li><p>It is also possible to enable/disable all triggers of a table
with <code>alter table ... enable/disable all triggers</code>:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> customers <span class="kw">enable</span> <span class="kw">all</span> <span class="kw">triggers</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.16" id="maps"><span class="header-section-number">1.4.16</span> Maps</h3>
<ul>
<li><p>Maps are also possible in PL/SQL using <code>table of</code>:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">type</span> country_capitals_type</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">is</span> <span class="kw">table</span> <span class="kw">of</span> <span class="dt">varchar2</span>(<span class="dv">100</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">index</span> <span class="kw">by</span> <span class="dt">varchar2</span>(<span class="dv">50</span>);</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    country_capitals country_capitals_type;</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    country_capitals(<span class="st">&#39;China&#39;</span>) <span class="op">:=</span> <span class="st">&#39;Beijing&#39;</span>;</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    country_capitals(<span class="st">&#39;EU&#39;</span>) <span class="op">:=</span> <span class="st">&#39;Brussels&#39;</span>;</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    country_capitals(<span class="st">&#39;USA&#39;</span>) <span class="op">:=</span> <span class="st">&#39;Washington&#39;</span>;</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
<li><p>You can use <code>mymap.first</code> and <code>mymap.next</code>
to iterate:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">type</span> country_capitals_type</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">is</span> <span class="kw">table</span> <span class="kw">of</span> <span class="dt">varchar2</span>(<span class="dv">100</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">index</span> <span class="kw">by</span> <span class="dt">varchar2</span>(<span class="dv">50</span>);</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>    country_capitals country_capitals_type;</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    current_country <span class="dt">varchar2</span>(<span class="dv">50</span>);</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    country_capitals(<span class="st">&#39;China&#39;</span>) <span class="op">:=</span> <span class="st">&#39;Beijing&#39;</span>;</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    country_capitals(<span class="st">&#39;EU&#39;</span>) <span class="op">:=</span> <span class="st">&#39;Brussels&#39;</span>;</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    country_capitals(<span class="st">&#39;USA&#39;</span>) <span class="op">:=</span> <span class="st">&#39;Washington&#39;</span>;</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    current_country <span class="op">:=</span> country_capitals.<span class="fu">first</span>;</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_country <span class="kw">is</span> <span class="kw">not</span> <span class="kw">null</span> <span class="cf">loop</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>        dbms_output.put_line(current_country <span class="op">||</span> <span class="st">&#39;: &#39;</span> <span class="op">||</span> country_capitals(current_country));</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>        current_country <span class="op">:=</span> country_capitals.<span class="kw">next</span>(current_country);</span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span> <span class="cf">loop</span>;</span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="1.4.17" id="arrays"><span class="header-section-number">1.4.17</span> Arrays</h3>
<ul>
<li><p>Using <code>varray</code>, it is also possible to create
arrays:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">type</span> names_type <span class="kw">is</span> <span class="dt">varray</span>(<span class="dv">255</span>) <span class="kw">of</span> <span class="dt">varchar2</span>(<span class="dv">20</span>) <span class="kw">not</span> <span class="kw">null</span>;</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    names names_type <span class="op">:=</span> names_type(<span class="st">&#39;Albert&#39;</span>, <span class="st">&#39;Jonathan&#39;</span>, <span class="st">&#39;Judy&#39;</span>);</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Length before append: &#39;</span> <span class="op">||</span> names.<span class="fu">count</span>);</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    names.extend;</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    names(names.<span class="fu">last</span>) <span class="op">:=</span> <span class="st">&#39;Alice&#39;</span>;</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Length after append: &#39;</span> <span class="op">||</span> names.<span class="fu">count</span>);</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    names.<span class="fu">trim</span>;</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Length after trim: &#39;</span> <span class="op">||</span> names.<span class="fu">count</span>);</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    names.<span class="fu">trim</span>(<span class="dv">2</span>);</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Length after second trim: &#39;</span> <span class="op">||</span> names.<span class="fu">count</span>);</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>    names.<span class="kw">delete</span>;</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>    dbms_output.put_line(<span class="st">&#39;Length after delete: &#39;</span> <span class="op">||</span> names.<span class="fu">count</span>);</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code></pre></div></li>
</ul>
</body>
</html>
